DROP VIEW IF EXISTS `mida`.`rep_casa_nal`;
CREATE OR REPLACE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `rep_casa_nal` AS (select distinct `n_casa`.`code_n_casa` AS `code_n_casa`,ifnull(sum(`sl_m_operation`.`sum_os_val_sl_mop`),0) AS `suma`,`sl_m_operation`.`in_type_sl_mop` AS `in_type_sl_mop`,`sl_m_operation`.`out_type_sl_mop` AS `out_type_sl_mop`,`sl_m_operation`.`levelx` AS `levelx` from (`n_casa` left join `sl_m_operation` on((`sl_m_operation`.`in_sl_mop` = `n_casa`.`id_n_casa`))) where (`sl_m_operation`.`in_type_sl_mop` = 1) group by `n_casa`.`code_n_casa`) union (select distinct `n_casa`.`code_n_casa` AS `code_n_casa`,ifnull(sum(`sl_m_operation`.`sum_os_val_sl_mop`),0) AS `suma`,`sl_m_operation`.`in_type_sl_mop` AS `in_type_sl_mop`,`sl_m_operation`.`out_type_sl_mop` AS `out_type_sl_mop`,`sl_m_operation`.`levelx` AS `levelx` from (`n_casa` left join `sl_m_operation` on((`sl_m_operation`.`out_sl_mop` = `n_casa`.`id_n_casa`))) where (`sl_m_operation`.`out_type_sl_mop` = 1) group by `n_casa`.`code_n_casa`);